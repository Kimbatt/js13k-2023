setTimeout(()=>{let oa=document.getElementById.bind(document),ja=document.createElement.bind(document);oa("st").innerHTML="#overlay,.fullscreen{top:0;width:100vw;height:100vh;position:absolute;left:0}#overlay,.hb{background:#000;display:flex}body{background:#323639;color:#fff;user-select:none;font-family:Verdana,sans-serif;overflow:hidden}canvas{z-index:-10;filter:saturate(1.3) brightness(1.4) contrast(1.4);position:absolute;top:0;left:0}.fullscreen{pointer-events:none;display:flex;flex-direction:column;align-items:center;z-index:9}#overlay{opacity:1;visibility:visible;transition:opacity .5s linear,visibility .5s linear;justify-content:space-evenly;font-size:4vh;text-align:center;white-space:pre-line;flex-direction:column;justify-content:center;align-items:center;gap:5vh}.we{position:absolute;z-index:-9;transform:translate(-50%,-50%);pointer-events:none;user-select:none}.hb{width:8vh;height:.6vh}.hb>div{margin:.15vh}#bc,#bi{position:absolute;width:30vh;height:fit-content;font-size:1.2vh;background:#000000e0;border-radius:1vh;margin:1vh;padding:1.5vh;white-space:pre-line}#bi{bottom:5vh;right:20%}#bc{display:flex;flex-direction:column;bottom:0;left:0;gap:1vh}#bi>div{display:flex;flex-direction:column;gap:3vh;width:100%}button{cursor:pointer;width:100%;font-size:1.2vh;background:#0064bb;color:#fff;padding:.8vh;border:0;border-radius:1vh}button:hover{background:#4084c0}button:disabled{background:#5f6e7a;pointer-events:none}.ability-container{display:flex;flex-direction:column;gap:1vh}.title{font-size:2vh;font-weight:700}@keyframes pulse{50%{color:#c75555}}.danger{animation:1s ease-in-out infinite pulse}#overlay.hidden{opacity:0;visibility:hidden}";
oa("ui").innerHTML='<div id=bc></div><div id=bi style=display:none></div><div style=position:absolute;top:0;right:20%;display:flex;background:#000000a0;border-radius:1vh;padding:1vh;margin:1vh;font-size:2vh;gap:4vh><div style=display:flex;gap:1vh;align-items:center><div id=food-count></div><svg style=height:2vh viewBox="0 0 120 100" stroke-width=5 stroke=#000><path d="M60 100q-10 0-10-10V40c0-10-10-10-10-20Q30 0 70 0q40 0 40 20c0 10-10 10-10 20v50q0 10-10 10z" fill=#faae3b /><path d="M20 100q-10 0-10-10V40C10 30 0 30 0 20Q0 0 40 0q40 0 40 20c0 10-10 10-10 20v50q0 10-10 10z" fill=#f8e6c5 /></svg></div><div style=display:flex;gap:1vh;align-items:center><div id=gold-count></div><svg style=height:2vh viewBox="0 0 125 100" stroke-width=5 stroke=#000><circle cx=75 cy=50 r=50 fill=#ff960c /><circle cx=50 cy=50 r=50 fill=#ffc60c /></svg></div></div><div id=overlay><div id=overlay-text></div><button id=start-level style="width:auto;font-size:4vh;padding:2vh 5vh"></button></div>';
let {PI:ka,abs:xb,sin:ba,cos:za,atan2:yb,round:Xa,sqrt:Zb,sign:$b,min:ta,max:La,random:ua,imul:ac}=Math,Q=ka/2,eb=-Q,pa=2*ka,Aa=(a,b,c)=>a+(b-a)*c,fb=(a,b,c)=>a<b?b:a>c?c:a,Ma=a=>()=>{let b=a+=1831565813;b=ac(b^b>>>15,b|1);b^=b+ac(b^b>>>7,b|61);return((b^b>>>14)>>>0)/4294967296},S=Float32Array,Ha=Uint32Array,Ia=(a,b)=>{b=a.indexOf(b);-1<b&&a.splice(b,1)},qa=a=>a.split(",").map(b=>+b);class zb extends S{constructor(a,b){super(a);this.c=()=>this.n.set(this);this.s=c=>this.set(c);this.h=(...c)=>this.set(c);
this.ib=()=>this.fill(0);this.da=c=>this.t.s(this).m(c).bb;this.r=()=>this.L(1/this.Y);this.Eb=()=>1E-9<this.Y?this.L(1/this.Y):this.ib();this.cb=c=>this.eb(this,c,.05);this.set(b??[])}set(a,b){super.set(a,b);return this}a(a){for(let b=0;b<this.length;++b)this[b]+=a[b];return this}m(a){for(let b=0;b<this.length;++b)this[b]-=a[b];return this}Va(a){for(let b=0;b<this.length;++b)this[b]/=a[b];return this}L(a){for(let b=0;b<this.length;++b)this[b]*=a;return this}Ha(a){let b=0;for(let c=0;c<this.length;++c)b+=
this[c]*a[c];return b}get bb(){return this.Ha(this)}get Y(){return Zb(this.bb)}eb(a,b,c){for(let d=0;d<this.length;++d)this[d]=Aa(a[d],b[d],c);return this}Sa(a,b){for(let c=0;c<this.length;++c)this[c]=fb(this[c],a[c],b[c]);return this}}class Lc extends zb{constructor(a=0,b,c){super(3,[a,b??a,c??a]);this.zb=(d,f)=>this.h(d.y*f.z-d.z*f.y,d.z*f.x-d.x*f.z,d.x*f.y-d.y*f.x)}get n(){return t()}get t(){return Mc}get x(){return this[0]}set x(a){this[0]=a}get y(){return this[1]}set y(a){this[1]=a}get z(){return this[2]}set z(a){this[2]=
a}V(a){let [b,c,d]=this,[f,g,h,l]=a;a=l*b+g*d-h*c;let k=l*c+h*b-f*d,n=l*d+f*c-g*b,q=f*b+g*c+h*d;this.x=a*l+q*f-k*h+n*g;this.y=k*l+q*g-n*f+a*h;this.z=n*l+q*h-a*g+k*f;return this}vb(a){let [b,c,d]=this,[f,g,h,l,k,n,q,r,m]=a;this.x=f*b+l*c+q*d;this.y=g*b+k*c+r*d;this.z=h*b+n*c+m*d}ba(a){let [b,c,d]=this,[f,g,h,l,k,n,q,r,m,p,w,u,v,y,G,A]=a;a=l*b+r*c+u*d+A;this.x=(f*b+k*c+m*d+v)/a;this.y=(g*b+n*c+p*d+y)/a;this.z=(h*b+q*c+w*d+G)/a;return this}}class Nc extends zb{constructor(a=0,b=0){super(2,[a,b])}get n(){return U()}get t(){return Oc}get x(){return this[0]}set x(a){this[0]=
a}get y(){return this[1]}set y(a){this[1]=a}}class Pc extends zb{constructor(a=0,b=0,c=0,d=1){super(4,[a,b,c,d]);this.multiply=f=>this.i(this,f);this.u=f=>this.i(f,this);this.M=(f,g,h,l)=>this.u(this.t.l(f,g,h,l))}get n(){return ra()}get t(){return Qc}l(a,b,c,d){d/=2;let f=ba(d);return this.h(a*f,b*f,c*f,za(d))}fa(){this[3]=-this[3];return this}i(a,b){let [c,d,f,g]=a,[h,l,k,n]=b;return this.h(c*n+g*h+d*k-f*l,d*n+g*l+f*h-c*k,f*n+g*k+c*l-d*h,g*n-c*h-d*l-f*k)}Gb(a,b){let c=a.Ha(b)+1,[d,f,g]=a;1E-7>c?
xb(d)>xb(g)?this.h(-f,d,0,0):this.h(0,-g,f,0):this.h(f*b.z-g*b.y,g*b.x-d*b.z,d*b.y-f*b.x,c);this.r()}}class Rc extends S{constructor(){super(9)}set(a,b){super.set(a,b);return this}fa(){let [a,b,c,d,f,g,h,l,k]=this,n=k*f-g*l,q=g*h-k*d,r=l*d-f*h,m=a*n+b*q+c*r;return this.set([n/m,(c*l-k*b)/m,(g*b-c*f)/m,q/m,(k*a-c*h)/m,(c*d-g*a)/m,r/m,(b*h-l*a)/m,(f*a-b*d)/m])}Jb(){let a;a=this[1];this[1]=this[3];this[3]=a;a=this[2];this[2]=this[6];this[6]=a;a=this[5];this[5]=this[7];this[7]=a;return this}}class Sc extends S{constructor(){super(16);
this.c=()=>ca().set(this);this.ga=a=>this.Ja(this,a);this.p=a=>this.Ja(a,this);this.Ma=a=>(a??Ab()).set([this[0],this[1],this[2],this[4],this[5],this[6],this[8],this[9],this[10]])}set(a,b){super.set(a,b);return this}Ja(a,b){let [c,d,f,g,h,l,k,n,q,r,m,p,w,u,v,y]=a,[G,A,K,B,F,M,V,sa,va,x,z,E,D,I,T,N]=b;return this.set([c*G+h*A+q*K+w*B,d*G+l*A+r*K+u*B,f*G+k*A+m*K+v*B,g*G+n*A+p*K+y*B,c*F+h*M+q*V+w*sa,d*F+l*M+r*V+u*sa,f*F+k*M+m*V+v*sa,g*F+n*M+p*V+y*sa,c*va+h*x+q*z+w*E,d*va+l*x+r*z+u*E,f*va+k*x+m*z+v*E,
g*va+n*x+p*z+y*E,c*D+h*I+q*T+w*N,d*D+l*I+r*T+u*N,f*D+k*I+m*T+v*N,g*D+n*I+p*T+y*N])}ca(a,b,c){let [d,f,g,h]=b,[l,k,n]=c;var q=d+d,r=f+f,m=g+g;b=d*q;c=d*r;let p=d*m,w=f*r,u=f*m,v=g*m;q=h*q;r=h*r;m=h*m;return this.set([(1-(w+v))*l,(c+m)*l,(p-r)*l,0,(c-m)*k,(1-(b+v))*k,(u+q)*k,0,(p+r)*n,(u-q)*n,(1-(b+w))*n,0,a.x,a.y,a.z,1])}Bb(a,b,c,d){this.set([.8/(b-a),0,0,0,0,.8/(c-d),0,0,(b+a)/(b-a),(c+d)/(c-d),500.4/-499.6,-1,0,0,400/-499.6,0])}Ab(){let a=1/600;this.set([.008,0,0,0,0,.008,0,0,0,0,-2*a,0,0,0,-400*
a,1])}}let U=(a,b)=>new Nc(a,b),t=(a,b,c)=>new Lc(a,b,c),ra=(a,b,c,d)=>new Pc(a,b,c,d),Ab=()=>new Rc,ca=()=>new Sc,wa=(a,b,c,d)=>ra().l(a,b,c,d),Na=(a,b,c)=>ca().ca(a,b,c),Oc=U(),Mc=t(),Qc=ra();class bc{constructor(a,b){this.Wa=(c,d)=>{(d??t()).s(this.d).L(c).a(this.ua)};this.ua=a.c();this.d=b.c().r()}}let cc=({ua:a,d:b})=>-a.y/b.y,Tc=({ua:a,d:b},c,d)=>{let f=-Infinity,g=Infinity,h=(k,n)=>k<n?k:n,l=(k,n)=>k>n?k:n;b=t(1).Va(b);for(let k=0;3>k;++k){let n=(c[k]-a[k])*b[k],q=(d[k]-a[k])*b[k];f=h(n>f?
n:f,q>f?q:f);g=l(n<g?n:g,q<g?q:g)}if(f>g||0>g)return null;0>f&&(f=g);return f},Uc=((a,b)=>(new S(a)).map((c,d)=>b(d/(a-1))))(16,a=>(1-a)**4),H=new AudioContext,gb=H.createGain();gb.gain.value=.2;let ea=H.createBiquadFilter();ea.type="lowpass";ea.frequency.value=2E4;ea.connect(gb).connect(H.destination);let dc=Ma(0),ec=[];for(let a=0;10>a;++a){let b=(new S(H.sampleRate)).map(()=>2*dc()-1),c=(new S(H.sampleRate)).map(()=>2*dc()-1),d=H.createBuffer(2,H.sampleRate,H.sampleRate);d.copyToChannel(b,0);d.copyToChannel(c,
1);ec.push(d)}let hb=(a=0)=>{let b=H.createBufferSource();b.buffer=ec[a];b.loop=!0;return b},fc=(a,b,c,d)=>{let f=H.createPeriodicWave(c,d);return(g,h,l,k,n,q=.2,r=0,m)=>{m=m??ea;g=2**(Math.log2(440)+g-4+(h-9)/12)/a;h=H.createOscillator();let p=H.createGain(),w=H.createBiquadFilter();h.frequency.value=g;p.gain.value=0;let u=k;p.gain.linearRampToValueAtTime(0,u);p.gain.linearRampToValueAtTime(b?1.4*l:l,u+=.001);p.gain.linearRampToValueAtTime(l,u+=.05);p.gain.linearRampToValueAtTime(l,u+=n);p.gain.linearRampToValueAtTime(0,
u+=q);w.type="bandpass";w.frequency.value=g;w.Q.value=-r;w.Q.linearRampToValueAtTime(-r,k);w.Q.linearRampToValueAtTime(0,k+.001);w.Q.linearRampToValueAtTime(r,u);h.connect(p).connect(w).connect(m);h.setPeriodicWave(f);h.start(k);h.stop(u);b&&(n=hb(),q=H.createGain(),r=H.createBiquadFilter(),r.frequency.value=8E3,r.Q.value=2,q.gain.value=0,q.gain.linearRampToValueAtTime(0,k),q.gain.linearRampToValueAtTime(.2*l,k+.001),q.gain.linearRampToValueAtTime(0,k+.001+.001),n.start(k),n.stop(k+.001+.001),n.connect(q).connect(r).connect(m))}},
Vc=fc(1,!0,qa("-.02,-.2,-.4,-.1,1,-.04,-.07,0,.1,-.3,-.1,.2,.15,.15,-.02,-.02,.02,-.1,.1,-.1"),qa("0,-4,.5,-.5,.07,0,-.17,-.05,.06,.21,-.46,-.3,-.14,.05,.07,.01,-.08,-.13,.04,-.01")),Wc=fc(1,!1,qa("-.02,-1,.17,.31,.18,.05,.06,.03,.02,.01,.01,.01"),qa("0,-.46,.72,.17,.11,.11,.08,.02,.01,.01,0,0")),ib=(a,b,c,d,f,g,h=.01,l=.1,k=0,n=Uc,q)=>{let r=H.createGain(),m=H.createBiquadFilter();r.gain.value=0;let p=b;r.gain.linearRampToValueAtTime(0,p);p+=h;r.gain.linearRampToValueAtTime(a,p);p+=k;r.gain.setValueCurveAtTime(n.map(w=>
w*a),p,l);p+=l;m.type=d?"bandpass":"allpass";m.frequency.value=f;m.Q.value=g;c.connect(r).connect(m).connect(q??ea);c.start(b);c.stop(p)},Ya=(a,b=.25,c)=>{var d=H.createOscillator();d.frequency.value=150;d.frequency.linearRampToValueAtTime(150,a+.01+.005);d.frequency.linearRampToValueAtTime(70,a+.03+.005);ib(.7,a+.005,d,!1,0,0,.001,.2,0,void 0,c);d=hb();let f=H.createBiquadFilter();f.Q.value=0;f.frequency.value=5E3;let g=H.createGain();d.start(a);d.stop(a+b);g.gain.value=.4;g.gain.linearRampToValueAtTime(.4,
a+.005);g.gain.linearRampToValueAtTime(.06,a+.01);g.gain.linearRampToValueAtTime(.06,a+.02);g.gain.linearRampToValueAtTime(0,a+b);d.connect(f).connect(g).connect(c??ea)},Xc=(a,b=8E3,c=.1,d)=>ib(1,a,hb(),!0,b,3,.001,c,.005,void 0,d),W=ja("canvas");document.body.appendChild(W);let e=W.getContext("webgl2"),jb=(a,b)=>{a=e.createShader(a);e.shaderSource(a,b);e.compileShader(a);return a},gc=(a,b)=>{let c=e.createProgram();e.attachShader(c,a);e.attachShader(c,b);e.linkProgram(c);return c},hc=(a,b,...c)=>
{a=jb(e.VERTEX_SHADER,a);b=jb(e.FRAGMENT_SHADER,b);let d=gc(a,b),f=new Map;c.forEach(g=>f.set(g,e.getUniformLocation(d,g)));return{$:d,T:f}},P=(()=>{let a=jb(e.VERTEX_SHADER,"#version 300 es\nin vec2 p;uniform float a;out vec2 pc;void main(){pc=(p+vec2(1))*.5;gl_Position=vec4(p,0,1);}"),b=e.createBuffer(),c=new S([-1,-1,1,-1,-1,1,1,1]);e.bindBuffer(e.ARRAY_BUFFER,b);e.bufferData(e.ARRAY_BUFFER,c,e.STATIC_DRAW);let d=e.createFramebuffer();return{F:(f,g,h,l,k,n)=>{W.width=h;W.height=l;e.viewport(0,
0,h,l);f=`#version 300 es
precision highp float;
in vec2 pc;out vec4 oc;uniform float a;const vec2 ps=vec2(${1/h},${1/l});
${k.map((r,m)=>`uniform sampler2D t${m};`).join("\n")}
${f.join("\n")}
void main(){${g}}`;f=jb(e.FRAGMENT_SHADER,f);let q=gc(a,f);e.useProgram(q);g=e.getAttribLocation(q,"p");e.uniform1f(e.getUniformLocation(q,"a"),h/l);k.forEach((r,m)=>{e.activeTexture(e.TEXTURE0+m);e.bindTexture(e.TEXTURE_2D,r);e.uniform1i(e.getUniformLocation(q,"t"+m),m)});e.bindFramebuffer(e.FRAMEBUFFER,d);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);e.bindBuffer(e.ARRAY_BUFFER,b);e.enableVertexAttribArray(g);e.vertexAttribPointer(g,2,e.FLOAT,!1,0,0);e.drawArrays(e.TRIANGLE_STRIP,
0,c.length/2);e.deleteShader(f);e.deleteProgram(q);e.bindFramebuffer(e.FRAMEBUFFER,null);e.bindTexture(e.TEXTURE_2D,n);e.generateMipmap(e.TEXTURE_2D);e.bindTexture(e.TEXTURE_2D,null)},D:(f,g)=>{let h=e.createTexture();e.bindTexture(e.TEXTURE_2D,h);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT);e.texImage2D(e.TEXTURE_2D,0,e.RGB10_A2,f,g,0,e.RGBA,e.UNSIGNED_INT_2_10_10_10_REV,null);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR);
(f=e.getExtension("EXT_texture_filter_anisotropic"))&&e.texParameterf(e.TEXTURE_2D,f.TEXTURE_MAX_ANISOTROPY_EXT,ta(16,e.getParameter(f.MAX_TEXTURE_MAX_ANISOTROPY_EXT)));return h}}})(),Ba=null,ic=null,Bb=()=>{ic||=hc("#version 300 es\nlayout(location=0) in vec4 m;out vec2 v;uniform mat4 e,d;void main(){v=m.xy+.5;gl_Position=e*d*m;}","#version 300 es\nprecision highp float;uniform sampler2D t;in vec2 v;void main(){if(texture(t,v).w<.5)discard;}","e","d","t");return ic},Y=(...a)=>{let b=[],c=[],d=[];
for(let f of a){let g=b.length/3;b.push(...f.v);d.push(...f.n);c.push(...f.t.map(h=>h+g))}return{v:new S(b),t:new Ha(c),n:new S(d)}},la=(a,b)=>{let {v:c,n:d}=a,f=b.Ma().fa().Jb(),g=t();for(let h=0;h<c.length;h+=3)g.set(c.slice(h,h+3)),g.ba(b),c.set(g,h),g.set(d.slice(h,h+3)),g.vb(f),d.set(g,h);return a},jc=ca(),C=(a,b,c,d)=>la(a,jc.ca(t(b,c,d),ra(),t(1))),kb=(a,b)=>la(a,jc.ca(t(),b,t(1))),Oa=(a,b,c,d,f)=>kb(a,wa(b,c,d,f)),R=structuredClone,da=(a=1,b=1,c=1)=>{a/=2;b/=2;c/=2;c=new S([-a,-b,-c,a,-b,
-c,-a,b,-c,a,b,-c,a,-b,c,-a,-b,c,a,b,c,-a,b,c,a,-b,-c,-a,-b,-c,a,-b,c,-a,-b,c,-a,b,-c,a,b,-c,-a,b,c,a,b,c,-a,-b,-c,-a,b,-c,-a,-b,c,-a,b,c,a,b,-c,a,-b,-c,a,b,c,a,-b,c]);a=new Ha(qa("0,3,1,0,2,3,4,7,5,4,6,7,8,11,9,8,10,11,12,15,13,12,14,15,16,19,17,16,18,19,20,23,21,20,22,23"));b=new S(qa("0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0"));return{v:c,t:a,n:b}},Cb=(a=1)=>{var b=[];let c=[];for(var d=
0;16>d;++d){var f=eb+ka*d/15,g=ba(-f);f=za(-f);for(var h=0;24>h;++h){let l=pa*h/23;b.push(za(l)*f,g,ba(l)*f)}}for(d=0;16>d;++d)for(g=24*d,f=g+24,h=0;24>h;++h)c.push(g+h,g+h+1,f+h+1,g+h,f+h+1,f+h);b=new S(b);return{v:b.map(l=>l*a),t:new Ha(c),n:b}},L=(a,b,c,d=16)=>{let f=a/2;a=[];let g=[],h=[];for(let k=0;k<=d;++k){var l=k/d*pa;let n=za(l);l=ba(l);a.push(n*b,-f,l*b,n*c,f,l*c);g.push(n,0,l,n,0,l)}a.push(...a);for(b=0;b<=d;++b)g.push(0,-1,0,0,1,0);for(b=0;b<2*d;b+=2)h.push(b,b+1,b+3,b,b+3,b+2);b=2*(d+
1);for(c=2;c<d;++c)h.push(b,b+2*c-2,b+2*c,b+1,b+2*c+1,b+2*c-1);return{v:new S(a),n:new S(g),t:new Ha(h)}},Ja=(a,b)=>{let c=[],d=[],f=[];var g=[];for(var h=0;h<a.length;h+=2)g.push(U(a[h],a[h+1]));for(let {x:l,y:k}of g)c.push(l,k,b/-2,l,k,b/2),f.push(0,0,-1,0,0,1);for(a=2;a<g.length;++a)h=a-1,d.push(0,2*h,2*a,1,2*a+1,2*h+1);a=g[g.length-1];for(let l of g){g=c.length/3;c.push(a.x,a.y,b/2,a.x,a.y,b/-2,l.x,l.y,b/2,l.x,l.y,b/-2);a=l.c().m(a).r();h=a.x;let k=-a.y;a=l;f.push(k,h,0,k,h,0,k,h,0,k,h,0);d.push(g,
g+3,g+1,g,g+2,g+3)}return{v:new S(c),t:new Ha(d),n:new S(f)}},Db=a=>{let {v:b,t:c}=a,d=[],f=[],g=[],h=t(),l=t(),k=t();for(let n=0;n<c.length;n+=3){let q=3*c[n],r=3*c[n+1],m=3*c[n+2];h.set(b.subarray(q,q+3));l.set(b.subarray(r,r+3));k.set(b.subarray(m,m+3));d.push(...h,...l,...k);f.push(n,n+1,n+2);l.m(h);k.m(h);h.zb(l,k).r();g.push(...h,...h,...h)}a.v=new S(d);a.t=new Ha(f);a.n=new S(g);return a},kc=a=>{let b=H.createPanner(),c=H.createGain();c.gain.value=.2;b.connect(c).connect(ea);b.refDistance=
10;a.P.push(()=>{let d=a.za,f=a.oa.f;b.setPosition(d.x,d.y,d.z);b.setOrientation(f.x,f.y,f.z)});return b},Yc=ca(),Zc=t(),$c=t(),ma=1/60.001,Eb=ma/2;class Z{constructor(){this.c=new Set;this.p=null;this.A=[];this.R=[];this.P=[];this.g=t();this.j=ra();this.I=t(1,1,1);this.v=!0;this.ha=0;this.S=!1;this.matrix=a=>(a??ca()).ca(this.g,this.j,this.I);this.qb=()=>{let a=this.j.c().fa();return ca().ca(this.g.c().L(-1).V(a),a,t(1,1,1).Va(this.I))};this.Pa=a=>a.ba(this.Aa());this.rb=a=>{a.V(this.Ra).r()}}a(...a){a.forEach(b=>
{this.c.add(b);b.p=this});return this}r(a){this.c.delete(a);a.p=null}Qa(a){(function d(c){a(c);c.c.forEach(d)})(this)}Aa(){let a=this.matrix();return this.p?.Aa().c().ga(a)??a.c()}lb(){let a=this.qb();return this.p?.lb().c().p(a)??a.c()}get za(){return this.Pa(t())}get Ra(){let a=ra(),b=this;for(;b;)a.multiply(b.j),b=b.p;return a}get oa(){let a=this.Ra;return{r:t(1,0,0).V(a).r(),kb:t(0,1,0).V(a).r(),f:t(0,0,-1).V(a).r()}}gb(){}X(){this.p?.r(this);this.A=[];this.R=[];this.P=[];this.c.forEach(a=>a.X())}}
class lc extends Z{constructor(){super(...arguments);this.va=ca();this.wa=null}U(a=1){let b=.4*Math.tan(.6981317008),c=2*b;a*=c;let d=a/2;this.va.Bb(d-a,d,b,b-c);this.wa={top:b,right:d,fb:.4,Ia:!0}}N(){this.va.Ab();this.wa={top:125,right:125,fb:-100,Ia:!1}}u(a,b){let c=this.wa;a=Aa(-c.right,c.right,a);b=Aa(-c.top,c.top,b);b=t(a,b,-c.fb);return c.Ia?new bc(t(),b.r()):new bc(b,t(0,0,-1))}J(a,b){a=this.u(a,b);this.Pa(a.ua);this.rb(a.d);return a}i(a){return this.J(a.clientX/window.innerWidth,1-a.clientY/
window.innerHeight)}H(a,b){b.s(a).ba(O.ab)}}class ad extends lc{constructor(){super();this.Fa=ca();this.xa=ta(e.getParameter(e.MAX_TEXTURE_SIZE),2048);this.N();this.Ta=e.createFramebuffer();this.Ga=e.createTexture();e.bindTexture(e.TEXTURE_2D,this.Ga);e.texImage2D(e.TEXTURE_2D,0,e.DEPTH24_STENCIL8,this.xa,this.xa,0,e.DEPTH_STENCIL,e.UNSIGNED_INT_24_8,null);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,
e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE);e.bindFramebuffer(e.FRAMEBUFFER,this.Ta);e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,this.Ga,0);this.Nb=Bb().T.get("d")}Db(){var a=ca().set([.894,.358,-.267,0,0,.6,.8,0,.447,-.717,.535,0,0,0,-1,1]);this.Fa.set(this.va).ga(a);a=Bb();e.useProgram(a.$);e.uniformMatrix4fv(a.T.get("e"),!1,this.Fa)}}let mc=[];class O extends Z{constructor(){super();this.clearColor=t();e.enable(e.DEPTH_TEST);e.depthFunc(e.LEQUAL);e.enable(e.CULL_FACE);
e.cullFace(e.BACK);this.i=new ad;O.now=performance.now()/1E3}J(a){O.ma=a-O.now;O.now=a;Eb+=O.ma;let b=Eb/ma|0;Eb-=ma*b;b=ta(b,10);this.Qa(c=>{c.A=c.A.filter(d=>!1!==d(c));for(let d=0;d<b;++d)c.R=c.R.filter(f=>!1!==f(c))})}H(a){let {i:b,clearColor:c}=this;e.viewport(0,0,b.xa,b.xa);e.bindFramebuffer(e.FRAMEBUFFER,b.Ta);e.clear(e.DEPTH_BUFFER_BIT);b.Db();this.u(b,1,b);e.bindFramebuffer(e.FRAMEBUFFER,null);e.viewport(0,0,W.width,W.height);e.clearColor(c.x,c.y,c.z,1);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);
this.u(a,0,b);this.Qa(d=>{d.P=d.P.filter(f=>!1!==f(d))})}u(a,b,c){let d=a.lb(),f=a.za,g=a.oa.f,h=O.ab.set(a.va).ga(d),l={Lb:d,Mb:h,xb:f},k=a.wa.Ia?r=>f.da(r):r=>g.Ha(Zc.s(r).m(f)),n=[],q=(r,m)=>{if(r.v){var p=(mc.pop()??ca()).Ja(m,r.matrix(Yc));m=$c.ib().ba(p);n.push({n:r,Ob:p,Ua:k(m)});r.c.forEach(w=>q(w,p))}};q(this,this.Aa());n.sort((r,m)=>{let p=r.n.S?1:-1;return r.n.S!=m.n.S?p:r.n.ha!=m.n.ha?r.n.ha-m.n.ha:(m.Ua-r.Ua)*p});n.forEach(({n:r,Ob:m})=>{r.gb(b,l,m,c);mc.push(m)})}}O.ma=.01;O.now=0;O.ab=
ca();let nc=new Map;class bd extends Z{constructor(a,b,c){super();let d=nc.get(a);d?(this.aa=d.aa,this.ja=d.ja,this.ea=d.ea,++d.Kb):(this.aa=e.createVertexArray(),e.bindVertexArray(this.aa),this.ja=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.ja),e.bufferData(e.ARRAY_BUFFER,a.v,e.STATIC_DRAW),e.enableVertexAttribArray(b),e.vertexAttribPointer(b,3,e.FLOAT,!1,0,0),this.ea=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.ea),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a.t,e.STATIC_DRAW),a.n&&c&&
(b=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,b),e.bufferData(e.ARRAY_BUFFER,a.n,e.STATIC_DRAW),e.enableVertexAttribArray(c),e.vertexAttribPointer(c,3,e.FLOAT,!0,0,0)),e.bindVertexArray(null),nc.set(a,{aa:this.aa,ja:this.ja,ea:this.ea,jb:a.t.length,Kb:1}));this.jb=a.t.length}}let cd=ca(),dd=ca(),ed=Ab(),fd=Ab(),gd=ca(),oc=t();class J extends bd{constructor(a,b){super(a,0,1);this.u=new Map;this.N=this.H=!0;this.J=e.BACK;Ba||(Ba=hc("#version 300 es\nlayout(location=0) in vec4 v;layout(location=1) in vec3 m;out vec3 y,u,f,n,r,z;out vec4 i;uniform mat4 s;uniform mat3 b;uniform mat4 t;uniform mat3 l;uniform mat4 e,p;void main(){y=(t*v).xyz;u=l*m;f=v.xyz;n=m;r=(s*v).xyz;z=b*m;gl_Position=e*v;i=p*s*v*.5+.5;}",
"#version 300 es\nprecision highp float;precision highp sampler2DShadow;uniform sampler2D d,a,w;uniform sampler2DShadow h;uniform mat3 b,l;uniform bool D,E,C;uniform vec4 B;uniform float A,F,G,H;uniform vec3 I,J,K,L;uniform bool M;in vec3 y,u,f,n,r,z;in vec4 i;out vec4 o;vec3 g(vec3 v){vec3 m=pow(abs(v),vec3(H));return m/vec3(dot(m,vec3(1)));}vec4 g(sampler2D v,vec3 m,vec3 y){vec3 i=g(y);return texture(v,m.zy)*i.x+texture(v,m.zx)*i.y+texture(v,m.xy)*i.z;}vec3 N(sampler2D v,vec3 m,vec3 y){vec3 i=g(y),n=texture(v,m.zx).xyz*2.-1.;return normalize(vec3(0,(texture(v,m.zy).xyz*2.-1.).yx)*i.x+vec3(n.y,0,n)*i.y+vec3((texture(v,m.xy).xyz*2.-1.).xy,0)*i.z+y);}float N(vec3 v,vec3 m){return max(dot(v,m),0.);}vec3 g(vec3 v,float m){return v+(1.-v)*pow(1.-m,5.);}vec3 N(vec3 v,vec3 m,vec3 y,vec3 b,vec3 s,vec3 n,vec3 d,float f){float I=N(v,y);vec3 x=normalize(y+m),J=g(d,dot(y,x));float e=pow(N(v,x),f)*(f+2.)/8.,u=0.;if(M){vec3 l=i.xyz/i.w;vec2 B=abs(vec2(.5)-l.xy);u=l.z>1.||B.x>.5||B.y>.5?1.:(l.z-=max(.001*(1.-dot(normalize(z),L)),1e-4)/i.w,texture(h,l));}else u=1.;vec3 o=u*(n+J*e)*I*b;o+=n*s;return o;}vec3 O(vec3 v,vec3 m){vec3 y=normalize(n);v=E?normalize(l*N(a,f*I+J,y)):v;vec3 s=D?g(d,f*I+J,y).xyz*B.xyz:B.xyz;float u=C?g(w,f*I+J,y).x:A;vec3 i=mix(s*(1.-vec3(.04).x),vec3(0),F)/acos(-1.),r=mix(vec3(.04),s,F);u=1.2-.2/clamp(u,1e-5,.99999);float x=log(2.-u)*185.;vec3 o=vec3(0),G[]=vec3[1](K),H[]=vec3[1](vec3(1)),p[]=vec3[1](vec3(1));{vec3 b=p[0]*(1.-N(z,-L)*.1);o+=N(v,m,G[0],H[0],b,i,r,x);}return o;}void main(){vec3 v=O(normalize(u),normalize(-y));o=vec4(mix(v,vec3(.4,.45,.5),smoothstep(150.,250.,length(r))),B.w);}",
"t","l","e","s","b","p","d","a","w","h","D","E","C","B","F","A","H","I","J","K","L","M"),e.useProgram(Ba.$),e.uniform1i(Ba.T.get("d"),0),e.uniform1i(Ba.T.get("a"),1),e.uniform1i(Ba.T.get("w"),2),e.uniform1i(Ba.T.get("h"),3));let {$:c,T:d}=Ba;this.$=c;this.U=d;e.useProgram(c);this.K={...b};this.Ca=Bb().$}Ba(){let {U:a,K:b}=this;e.uniform1i(a.get("d"),0);e.uniform1i(a.get("a"),1);e.uniform1i(a.get("w"),2);e.uniform1i(a.get("D"),0);e.uniform1i(a.get("E"),0);e.uniform1i(a.get("C"),0);e.uniform1i(a.get("M"),
this.N?1:0);e.uniform1f(a.get("H"),1);e.uniform3f(a.get("I"),1,1,1);e.uniform3f(a.get("J"),0,0,0);for(var c=0;8>c;++c)e.activeTexture(e.TEXTURE0+c),e.bindTexture(e.TEXTURE_2D,null);if(b){e.uniform4f(a.get("B"),b.r,b.o,b.b,b.a);e.uniform1f(a.get("F"),b.Z??0);c=1.2-.2/fb(b.C??.5,1E-5,.99999);e.uniform1f(a.get("A"),c);e.uniform1f(a.get("H"),b.O??1);b.B&&e.uniform3fv(a.get("I"),b.B);b.ya&&e.uniform3fv(a.get("J"),b.ya);for(let [d,f]of this.u)e.activeTexture(e.TEXTURE0+d),e.bindTexture(e.TEXTURE_2D,f),
e.uniform1i(a.get(["D","E","C"][d]),f?1:0)}null!=this.J?(e.enable(e.CULL_FACE),e.cullFace(this.J)):e.disable(e.CULL_FACE);this.S?(e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)):e.disable(e.BLEND)}i(a){this.u.set(0,a.ka);this.u.set(1,a.ta);this.u.set(2,a.C);return this}gb(a,b,c,d){if(1!=a||this.H){var {U:f}=this,{Lb:g,Mb:h}=b;e.useProgram(0==a?this.$:this.Ca);e.bindVertexArray(this.aa);if(0==a){a=cd.set(g).ga(c);let l=dd.set(h).ga(c),k=a.Ma(ed).fa(),n=c.Ma(fd).fa();e.uniformMatrix4fv(f.get("t"),
!1,a);e.uniformMatrix4fv(f.get("e"),!1,l);e.uniformMatrix4fv(f.get("s"),!1,c);e.uniformMatrix3fv(f.get("l"),!0,k);e.uniformMatrix3fv(f.get("b"),!0,n);e.uniform3fv(f.get("K"),oc.s(d.g).a(b.xb).ba(d.matrix(gd).p(g)).r());e.uniform3fv(f.get("L"),oc.s(d.g).r());this.Ba();e.activeTexture(e.TEXTURE0+3);e.bindTexture(e.TEXTURE_2D,d.Ga);e.uniformMatrix4fv(f.get("p"),!1,d.Fa);e.depthMask(!this.S)}else e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.uniformMatrix4fv(d.Nb,!1,c),e.depthMask(!0);
e.drawElements(e.TRIANGLES,this.jb,e.UNSIGNED_INT,0);e.bindVertexArray(null);e.depthMask(!0)}}}let hd=t(-120,0,-120),id=t(120,0,120);class jd extends Z{constructor(a){super();this.N=0;this.u=.8;this.i=50;this.J=a;this.a(a);this.H()}Ba(a,b){let c=2*window.innerHeight/1E3;this.N+=a*c/window.innerHeight;this.u+=b*c/window.innerHeight;this.H()}U(a,b){let {r:c,kb:d}=this.J.oa,f=1.5*window.innerHeight/1E3;b=b*this.i*f/window.innerHeight;a=c.L(a*this.i*f/window.innerHeight).m(d.L(b));this.g.m(a);this.g.Sa(hd,
id)}Ca(a){a=this.i*(1+.07*$b(a));this.i=10>a?10:200<a?200:a;this.H()}H(){this.u=fb(this.u,.3,Q);var a=wa(0,1,0,-this.N),b=wa(1,0,0,-this.u);a=a.multiply(b);b=t(0,0,this.i).V(a);this.J.j.s(a);this.J.g.s(b)}}let lb=a=>`vec3 o=vec3(-1,1,0);oc=vec4(normalize(vec3(float(${a})*(texture(t0,pc+ps*o.xz).x-texture(t0,pc+ps*o.yz).x),float(${a})*(texture(t0,pc+ps*o.zx).x-texture(t0,pc+ps*o.zy).x),ps.y*100.))*.5+.5,1);`,mb="vec2 voro(vec2 i,float s){vec2 v=floor(i),f=fract(i),d=vec2(0,8);for(int x=-2;x<=2;++x)for(int y=-2;y<=2;++y){vec2 h=vec2(y,x),N=h2(v+h);float M=length(h-f+N),L=.5+.5*sin(h1(dot(v+h,vec2(7,113)))*2.5+5.),K=smoothstep(0.,1.,.5+.5*(d.y-M)/s);d.y=mix(d.y,M,K)-K*(1.-K)*s/(1.+3.*s);d.x=mix(d.x,L,K)-K*(1.-K)*s/(1.+3.*s);}return d;}",
nb="float vD(vec2 i){vec2 v=floor(i),n=fract(i),d,D;float f=8.;for(int h=-1;h<=1;++h)for(int M=-1;M<=1;++M){vec2 m=vec2(M,h),K=m+h2(v+m)-n;float J=dot(K,K);if(J<f)f=J,D=K,d=m;}f=8.;for(int h=-2;h<=2;++h)for(int M=-2;M<=2;++M){vec2 m=d+vec2(M,h),K=m+h2(v+m)-n;float J=dot(.5*(D+K),normalize(K-D));f=min(f,J);}return f;}",xa="float h1(float n){return fract(sin(n)*43758.5453);}vec2 h2(vec2 p){p=vec2(dot(p,vec2(127.1,311.7)),dot(p,vec2(269.5,183.3)));return fract(sin(p)*43758.5453);}float se(float x){return clamp(x,0.,1.);}float ul(float a,float b,float x){return(x-a)/(b-a);}float rp(float a,float b,float c,float d,float x){return mix(c,d,ul(a,b,x));}float sr(float e,float f,float x){return se(ul(e,f,x));}vec4 cr(vec4 a,float A,vec4 b,float B,float t){return mix(a,b,sr(A,B,t));}vec3 cr3(vec3 a,float A,vec3 b,float B,float t){return mix(a,b,sr(A,B,t));}float vr(float a,float A,float b,float B,float t){return mix(a,b,sr(A,B,t));}vec2 grad(ivec2 x){int f=x.x+x.y*11111;f=f<<13^f;f=f*(f*f*15731+789221)+1376312589>>16;return vec2(cos(float(f)),sin(float(f)));}float noise(vec2 f){ivec2 g=ivec2(floor(f));vec2 x=fract(f),d=x*x*(3.-2.*x),i=vec2(ivec2(0,1));return mix(mix(dot(grad(g+ivec2(0,1).xx),x-i.xx),dot(grad(g+ivec2(0,1).yx),x-i.yx),d.x),mix(dot(grad(g+ivec2(0,1).xy),x-i.xy),dot(grad(g+ivec2(0,1).yy),x-i.yy),d.x),d.y)*.5+.5;}float fbm(vec2 f,int g,float x,float y){float d=0.,i=1.;for(int r=0;r<g;++r)i*=.5,d+=i*noise(f*x),f*=y;return d/(1.-i);}",
Ca=(a,b=.2,c="vec4",d="eb")=>`
${c} ${d}(vec2 u){vec2 w=vec2(${b}),s=1.-w,o=u*s,b=clamp((u-s)/w,0.,1.);return b.y*b.x*${a}(fract(o+(w*2.)))+b.y*(1.-b.x)*${a}(vec2(fract(o.x+w.x),fract(o.y+(w.y*2.))))+(1.-b.y)*(1.-b.x)*${a}(fract(o+w))+(1.-b.y)*b.x*${a}(vec2(fract(o.x+(w.x*2.)),fract(o.y+w.y)));}`,Fb=(a,b,c=4,d=2,f=.03,g=.5,h=.05,l=.2,k=1,n=.1,q=!1,r=.5,m=1,p=[.3,.22,.07],w=[.8,.75,.7],u=.5)=>{let v=1/c,y=1/d,G=v/y;var A=B=>`
vec2 gn(vec2 c){c*=float(${k});return vec2(fbm(c,5,10.,2.),fbm(c+vec2(1.23,4.56),5,10.,2.));}
float gv(vec2 c){return vD(c*${c}.);}
${Ca("gn",.2,"vec2","gsn")}
${Ca("gv",.01,"float","gsv")}
vec4 gc(vec2 c){vec2 n=gsn(c)-.5;c+=n*float(${h});${q?`float d=smoothstep(float(${f}),float(${f+n}),gsv(c));`:`float rh=float(${v}),cw=float(${y}),y=c.y/rh,x=c.x/cw,ox=floor(y)*float(${g}),iy=.5-float(${f})-n.x*float(${l}),ay=iy-float(${n}),ix=.5-(float(${f})-n.y*float(${l}))*float(${G}),ax=ix-float(${n})*float(${G}),d=min(smoothstep(ix,ax,abs(.5-fract(x+ox))),smoothstep(iy,ay,abs(.5-fract(y))));`}${B?`d+=(n.x+n.y-.05)*.5;vec3 q=mix(vec3(${w.join(",")}),vec3(${p.join(",")}),vec3(d));return vec4(q,1);`:
`d+=n.x+n.y-.05;return vec4(vec3(rp(0.,1.,float(${r}),float(${m}),d)),1);`}}`;d=P.D(a,b);P.F([xa,nb,A(!0)],"oc=gc(pc);",a,b,[],d);let K=P.D(a,b);P.F([xa,nb,A(!1)],"oc=gc(pc);",a,b,[],K);A=P.D(a,b);P.F([],lb(u),a,b,[K],A);u=P.D(a,b);P.F([xa],`oc=vec4(vec3(float(${r})+float(${m})-texture(t0,pc).x),1);`,a,b,[K],u);return{ka:d,C:u,ta:A}},kd=()=>{var a=d=>`vec4 gc(vec2 u){vec2 c=u*10.,n=vec2(fbm(c,5,1.,2.),fbm(c+vec2(1.23,4.56),5,1.,2.));float v=sqrt(voro(n*10.,1.).y)*1.5;${d?"return cr(vec4(.95,.95,.95,1),.2,vec4(1),.8,mix(v,n.x,.5))*vec4(1);":
"return vec4(vec3(rp(0.,1.,.8,1.,se(vr(.4,.3,.6,.7,v))*.2-n.x*1.)),1);"}}`;let b=P.D(1024,1024);P.F([xa,mb,a(!0),Ca("gc")],"oc=eb(pc);",1024,1024,[],b);let c=P.D(1024,1024);P.F([xa,mb,a(!1),Ca("gc")],"oc=eb(pc);",1024,1024,[],c);a=P.D(1024,1024);P.F([],lb(5),1024,1024,[c],a);return{ka:b,C:c,ta:a}},ld=()=>{var a=d=>`vec4 gc(vec2 u){u.y*=.1;float n=rp(.1,.6,0.,1.,fbm(voro(u*15.,1.5)*vec2(10,3),4,10.,3.));${d?"return vec4(n<.65?cr3(vec3(0),.35,vec3(.55,.35,.2),.65,n):n<.85?cr3(vec3(.55,.35,.2),.65,vec3(.75,.55,.45),.85,n):cr3(vec3(.75,.55,.45),.85,vec3(.75,.6,.5),.9,n),1);":
"return vec4(vec3(mix(.5,1.,smoothstep(.4,.8,n))),1);"}}`;let b=P.D(2048,2048);P.F([xa,mb,a(!0),Ca("gc")],"oc=eb(pc);",2048,2048,[],b);let c=P.D(2048,2048);P.F([xa,mb,a(!1),Ca("gc")],"oc=eb(pc);",2048,2048,[],c);a=P.D(2048,2048);P.F([],lb(.5),2048,2048,[c],a);return{ka:b,C:c,ta:a}},Gb={r:.3,o:.23,b:.05,a:1},Za={r:1,o:1,b:1,a:1},pc=a=>{let b=H.currentTime+.05,c=(d,f,g)=>{let h=H.createOscillator();h.frequency.value=d;ib(g,b,h,!1,0,0,.001,f,.001,void 0,a)};c(6E3,.1,.5);c(5E3,.9,.3);c(4500,.3,.3);c(3500,
.4,1);c(1500,1,.4);Xc(b,3500,.13,a)},md=a=>{let b=H.currentTime+.05;Ya(b,.05,a);ib(.3,b+.01,hb(),!1,0,0,.05,.5,.001,void 0,a)},nd=()=>{let a=H.currentTime+.1,b=0,c=6,d=Ma(0),f=Ma(0),g=()=>{let l=c/4,k=c/8,n=c/16,q=c/32,r=H.currentTime+3;for(;a<r;){0==b++%2&&(f=Ma(10*d()|0));let p=a;a+=c;let w=(u,v,y)=>Vc(u,v,1,y,.2,void 0,.5+4*d());var m=p;m+=k;Ya(m,.4);m+=l;Ya(m,.4);m+=l;Ya(m,.4);m+=l;Ya(m,.4);m=[[0,2,4,7,9],[2,4,7,9,12],[4,7,9,12,14]];m=m[f()*m.length|0];for(let u=0;16>u;++u){let v=m[f()*m.length|
0]-3;Wc(2,v,.4,p+n*u,.2,.4,.1);.8<f()?(w(2,v,p+2*q*u),w(2,m[f()*m.length|0]-3,p+q*(2*u+1))):w(2,v,p+n*u);++u;v=m[f()*m.length|0]-3;let y=f();.95<y||(.6<y?(w(2,v,p+2*q*u),w(2,m[f()*m.length|0]-3,p+q*(2*u+1))):w(2,v,p+n*u))}}};g();let h=setInterval(g,1379);return{stop:()=>clearInterval(h),Fb:l=>c=l}},ob=Ja([0,-.4,-.3,-.2,-.3,.3,0,.3,.3,.3,.3,-.2],.04);[0,1,16,17,14,15,6,7,28,29,26,27].forEach(a=>ob.v[3*a+2]+=.1);Db(ob);let od=Ja([0,.8,.02,.75,.02,0,-.02,0,-.02,.75],.005),pd=Y(da(.15,.03,.03),C(L(.14,
.015,.015),0,-.07,0)),qd=()=>{let a=new Z,b=new J(od,{r:4,o:4,b:4,a:1,Z:.8,C:.4}),c=new J(pd,{...Gb,Z:0,C:.8});return a.a(b,c)},rd=Y(L(.3,.02,.02),C(Oa(L(.3,.02,.02),1,0,0,.5),0,.27,.07),C(Oa(L(.3,.02,.02),1,0,0,-.5),0,-.27,.07)),sd=C(L(.75,.005,.005),0,0,.14),td=()=>{let a=new Z,b=new J(rd,{...Gb}),c=new J(sd,{...Za});return a.a(b,c)},ud=Y(C(L(2.3,2.3*.8,.02),0,1.4,0),C(L(2,1.6,.02),0,2,0),C(L(1.7,1.36,.02),0,2.6,0),C(L(1.4,1.4*.8,.02),0,3.2,0),C(L(1.1,1.1*.8,.02),0,3.8,0),C(L(.8,.8*.8,.02),0,4.3,
0)),vd=()=>{let a=new J(ud,{r:0,o:.4+.4*ua(),b:.2*ua(),a:1}),b=.8+ua(),c=.9+.2*ua();a.I.h(c,b,c);return a},wd={...Za,Z:.6,C:.2,B:t(5),O:20},xd=Cb(.025),yd=((a=1,b=1)=>Y(C(Cb(a),0,b/2,0),C(Cb(a),0,-b/2,0),L(b,a,a)))(.3,.2),zd=L(.5,.3,.25),qc=C(L(.4,.08,.1),0,-.2,0),rc=C(L(.4,.07,.1),0,-.2,0),sc=Oa(Ja([.08,0,-.22,0,-.22,.035,-.2,.05,-.03,.1,.05,.1,.08,.03],.14),0,1,0,eb),tc=C(L(.3,.05,.08),0,-.15,0),uc=C(L(.4,.03,.05),0,-.2,0),vc=(a,b,c)=>{a=a%1*2-1;let d=$b(a);a=ka-d*a*c;return d*ba(a)*b**a},Hb=(a,
b)=>{var c=B=>new J(B,{...wd,C:.6}),d=c(xd);let f=c(yd),g=c(zd),h=c(qc);var l=c(rc);let k=c(sc),n=c(qc),q=c(rc),r=c(sc),m=c(tc);var p=c(uc);let w=c(tc);c=c(uc);let u=0,v=ua(),y=(B,F,M)=>{F=(ba(6*(O.now+v)+F*pa)+1)/2;B.j.l(1,0,0,(.6-F**1.2)*M)},G=(B,F,M)=>{B.j.l(1,0,0,(.15*vc(3*(O.now+v)/ka+(F+.05),2,5)-.6)*M)};h.A.push(B=>y(B,0,u));n.A.push(B=>y(B,.5,u));l.A.push(B=>G(B,0,u));q.A.push(B=>G(B,.5,u));d.g.y=1.55;d.I.h(3.5,4.5,4);f.g.y=1.05;f.I.h(.7,1,.5);g.g.y=.95;g.I.h(.75,1,.5);h.g.h(-.11,.8,0);n.g.h(.11,
.8,0);l.g.h(0,-.4,0);l.I.h(.85,1,.85);q.g.h(0,-.4,0);q.I.h(.85,1,.85);h.a(l);n.a(q);k.g.y=-.4;r.g.y=-.4;l.a(k);q.a(r);m.g.h(-.15,1.32,0);m.a(p);p.g.h(0,-.3,0);w.g.h(.15,1.32,0);w.a(c);c.g.h(0,-.3,0);let A=new Z;l=new Z;A.a(l.a(d,f,g,h,n,m,w));l.A.push(B=>{var F=u;let M=12*(O.now+v),V=.05*F;B.g.z=((ba(M+2)+1)/2)**2*V;B.g.y=Aa(.02,.04*((ba(M+1)+1)/2)**2-.05,F)});d=null;b?(m.j.l(1,0,0,1).M(0,1,0,.4),p.j.l(0,0,1,1).M(1,0,0,1),w.j.l(0,1,0,.5).M(1,0,0,1.3),c.j.l(1,0,0,.4),d=td(),d.g.y=-.4,d.j.l(0,1,0,-.2).M(1,
0,0,-Q),c.a(d)):(m.j.l(1,0,0,1).M(0,1,0,.4),p.j.l(0,0,1,1.8),c.j.l(1,0,0,1.2),w.j.l(0,0,1,.5).M(1,0,0,.5),b=new J(ob,{r:.5,o:1,b:.5,a:1,Z:.6,C:0,B:t(2)}),a&&(b.K.r=1,b.K.o=.3),p.a(b),b.g.y=-.15,b.j.l(0,0,1,Q).M(0,1,0,-2.2),p=qd(),c.a(p),p.g.h(0,-.35,-.06),p.j.l(1,0,0,eb).M(0,0,1,Q));let K=0;return{node:A,ra:a,G:100,sa:100,$a:!1,wb:d,Hb(){let B=++K;A.A.push(()=>{u=ta(u+2*O.ma,1);return K==B&&1>u})},Ib(){let B=++K;A.A.push(()=>{u=La(u-2*O.ma,0);return K==B&&0<u})},Cb(){let B=O.now;A.A.push(()=>{let F=
ta((O.now-B)/1.5,1),M=ba(ka*(2*F-.5))/2+.5;w.j.l(0,0,1,.5).M(1,0,0,.5).M(1,0,0,(1-F-vc(F,2,6)/2)*M);return 1>F})}}},Ad=U(),Bd=U(),$a=U(),wc=(a,b,c,d,f)=>{a=Ad.s(b).m(a).r();b=Bd.s(c).m(b).r();b=a.a(b).r();return f.h(b.y,-b.x).L(d)},X=new O,Da=new lc,Pa=new jd(Da);Pa.i=50;Pa.H();X.a(Pa);(a=>{let {listener:b}=H;a.P.push(()=>{let c=a.za,{kb:d,f}=a.oa;b.setPosition(c.x,c.y,c.z);b.setOrientation(f.x,f.y,f.z,d.x,d.y,d.z)})})(Da);let Ib=!1,Jb=!1,xc=()=>{Da.U((W.width=window.innerWidth)/(W.height=window.innerHeight))};
requestAnimationFrame(xc);window.addEventListener("resize",xc);let Qa=oa("bi"),Kb=null;W.addEventListener("mousedown",a=>{1==a.button&&(Ib=!0);2==a.button&&(Jb=!0);0==a.button&&(a=yc(a),Qa.style.display=a?"flex":"none",Kb?.ia.Za(),Kb=a,Kb?.ia.show())});let yc=a=>{if(Lb)return null;a=Da.i(a);let b=null,c=null;for(let d of Ea){let f=Tc(a,d.Ea,d.Da);null!=f&&(null==b||f<b)&&(b=f,c=d)}return c},Mb=a=>{a=yc(a);W.style.cursor=a?"pointer":""};W.addEventListener("mousemove",Mb);window.addEventListener("mouseup",
a=>{1==a.button&&(Ib=!1);2==a.button&&(Jb=!1)});window.addEventListener("mousemove",a=>{Ib&&Pa.U(a.movementX,a.movementY);Jb&&Pa.Ba(a.movementX,a.movementY)});W.addEventListener("wheel",a=>{a.preventDefault();Pa.Ca(a.deltaY);Mb(a)});window.addEventListener("contextmenu",a=>a.preventDefault());window.addEventListener("keydown",a=>{"Escape"==a.key&&Ra()});let Nb=!1,zc=a=>{requestAnimationFrame(zc);Nb&&(X.J(a/1E3),X.H(Da))};requestAnimationFrame(zc);X.clearColor.h(.4,.45,.5);X.i.g.h(-1,3,2);let Cd=Fb(2048,
2048,90,90,.02,.5,.03,.4,4,.2,!0,.7,1,[.85,.85,.8],[.5,.5,.5],3),Dd={...Za,B:t(.03)},Ed=(()=>{var a=d=>`vec4 gc(vec2 u){vec2 c=u*50.;float q=rp(0.,1.,.3,1.,fbm(c*1.5,3,1.,2.)),h=se(1.-se(1.-vD(vec2(1)-vec2(fbm(c,5,1.,2.),fbm(c+vec2(1.23,4.56),5,1.,2.))*4.)*40.)*sr(.45,.52,fbm(c*2.,3,1.,2.)))*q;${d?"return cr(vec4(0,0,0,1),.08,vec4(.7,.9,.4,1),.67,q)*vec4(h,h,h,1);":"return vec4(vec3(rp(0.,1.,.7,1.,h)),1);"}}`;let b=P.D(1024,1024);P.F([xa,nb,a(!0),Ca("gc")],"oc=eb(pc);",1024,1024,[],b);let c=P.D(1024,
1024);P.F([xa,nb,a(!1),Ca("gc")],"oc=eb(pc);",1024,1024,[],c);a=P.D(1024,1024);P.F([],lb(1),1024,1024,[c],a);return{ka:b,C:c,ta:a}})(),Fd={...Za,B:t(.2)},pb=new J(da(500,1,500),Fd);pb.i(Ed);pb.g.y=-.5;pb.ha=100;X.a(pb);let qb=qa("-400,20,-354.78,20,-300,20,-240,20,-184,20,-138.4,20,-115.6,20,-107,20,-99,20,-93.58,20,-87.42,20,-80.8,20,-73.51,19.77,-66,19.18,-58.64,18.6,-51.37,18.41,-44.4,19,-38,20.74,-32.31,24.14,-26.96,28.64,-21.78,33.35,-16.59,37.35,-11.23,39.77,-5.73,40.16,.15,39.38,6.11,37.67,11.79,35.28,16.8,32.41,20.68,29.39,23.62,26.27,26.26,22.66,28.36,18.79,29.72,14.89,30.12,11.16,29,7.5,25.75,3.94,21.25,.47,16.45,-3,12.33,-6.6,9.85,-10.37,9.02,-13.92,8.88,-17.69,9.17,-21.52,9.62,-25.22,9.95,-28.62"),
Gd=((a,b)=>{let c=U(),d=U(),f=U(),g=[],h=[],l=[];for(let k=2;k<a.length-2;k+=2)c.h(a[k-2],a[k-1]),d.h(a[k],a[k+1]),f.h(a[k+2],a[k+3]),wc(c,d,f,b,$a),g.push(d.x+$a.x,0,d.y+$a.y,d.x-$a.x,0,d.y-$a.y),k!=a.length-4&&h.push(k-2,k-1,k,k,k-1,k+1);for(a=0;a<g.length;a+=3)l.push(0,1,0);return{v:new S(g),t:new Ha(h),n:new S(l)}})(qb,3),Ob=new J(Gd,Dd);Ob.g.y=.02;Ob.i(Cd);X.a(Ob);let Sa=[];for(let a=0;a<qb.length;a+=2)Sa.push(U(qb[a],qb[a+1]));let rb=t(),Ac=t(),Hd=(a,b,c,d="")=>{Ac.s(a.g).y+=b;Da.H(Ac,rb);c.style.display=
1<rb.z?"none":d;c.style.left=Xa((rb.x+1)/2*window.innerWidth)+"px";c.style.top=Xa((1-rb.y)/2*window.innerHeight)+"px"},Bc=(a,b)=>{let c=ja("div");c.className="we hb";document.body.appendChild(c);let d=ja("div");c.appendChild(d);a.P.push(()=>Hd(a,b,c));return{Ya:c,Xa:d,hb(f,g){d.style.width=La(f/g*100,0)+"%"}}},{pb:Id,mb:Jd,ub:Kd,sb:Cc,tb:Ld,nb:Md,ob:Nd}=(()=>{let a={...Za,Z:0,C:1,B:t(1)},b=Fb(1024,1024,6,3,.05,void 0,.05,.5,1.1,void 0,!1,void 0,void 0,[1,1,1],void 0,3),c=ld(),d=Fb(1024,1024,1,8,.01,
0,.05,.05,1,.05,!1,.5,.8,[1,1,1],[1,1,1],2),f=Ja([0,5,3,3,2.5,3,0,4.66,-2.5,3,-3,3],8),g=Ja([0,4.8,2.4,3.1,2.4,0,-2.4,0,-2.4,3.1],7.5),h=da(1.2,2.2,.1),l=da(.1,1,.8),k=x=>{var z=Pb=>(ua()-.5)*Pb,E=.8+z(.4),D=.5+z(.3),I=.35+z(.2);let T=new J(g,a);z=new J(f,{...a,r:E,o:D,b:I,a:1,B:t(.1,.3,.3+z(.2)),ya:t(.5,.5,0),O:10});E=new J(h,{...a,B:t(.5)});var N={...a,r:.2,o:.2,b:.2,a:1,C:.2};D=new J(l,N);I=new J(l,N);N=new J(l,N);T.i(b);E.i(c);z.i(d);E.g.h(0,1.1,-3.75);D.g.h(2.4,1.8,-2);I.g.h(2.4,1.8,2);N.g.h(-2.4,
1.8,1);let Ta=new Z;Ta.j.l(0,1,0,ka/(.5>ua()?-2:2));x&&(T.K.r=T.K.o=T.K.b=.6,z.K.r=z.K.o=z.K.b=.2);return Ta.a(T,z,E,D,I,N)},n=kd(),q=L(8,4,3,32),r=L(2.5,3.2,0,32),m=Y(la(L(5,.2,.2),Na(t(0,0,2),wa(1,0,0,Q),t(1))),da(.3,12,.3),da(12,.3,.3)),p=(()=>{let x=Ma(1),z=ra(),E=[];for(let I=0;2E3>I;++I){let T=Aa(-6,6,x()),N=Aa(.8,1.2,x()),Ta=Aa(-20,0,x());var D=Aa(.3,.6,x());let Pb=x()*pa,Od=.1*x();D=da(.05,N,.05*D);C(D,0,N/2,0);kb(D,z.l(1,0,0,Od));kb(D,z.l(0,1,0,Pb));C(D,T,0,Ta);E.push(D)}return Y(...E)})(),
w=(()=>{let x=da(1,5,.01),z=Na(t(.5,3.4,0),ra(),t(1)),E=Na(t(),wa(0,0,1,Q),t(1)),D=R(x);la(x,z);let I=R(D);la(D,z.p(E));let T=R(I);la(I,z.p(E));la(T,z.p(E));return Y(x,D,I,T)})(),u=Y(C(L(8,2,2),0,4,0),Db(C(L(1,2.4,2.4,12),0,8.5,0)),...[1,3,5,7,9,11].map(x=>{x=ka/12+ka/6*x;let z=2.4-.2-.08,E=da(.4,.8,1.4);kb(E,wa(0,1,0,-x));return C(E,za(x)*z,9.4,ba(x)*z)}));var v=x=>[...Array(x).keys()].map(z=>C(da(1.8,.8,.4),2.7*(z-(x-1)/2),8.4,1.2)),y=x=>Oa(Ja([-1,8,1.4,8,1.4,7,1,6,1,0,-1,0],x),0,1,0,eb);let G=
Y(y(50),...v(17));var A=Y(y(14),...v(5));v=Y(y(10.8),...v(3));y=(x,z,E,D,I)=>C(Oa(R(x),0,1,0,z),E,D,I);let K=Y(y(A,0*Q,0,0,7),y(A,Q,7,0,0),y(A,2*Q,0,0,-7),y(A,3*Q,-7,0,0),C(R(u),7,0,7),C(R(u),-7,0,7),C(R(u),7,0,-7),C(R(u),-7,0,-7),y(v,0*Q,0,5,4),y(v,Q,4,5,0),y(v,2*Q,0,5,-4),y(v,3*Q,-4,5,0),C(R(u),4,5,4),C(R(u),-4,5,4),C(R(u),4,5,-4),C(R(u),-4,5,-4),la(R(u),Na(t(0,8,0),ra(),t(1.5,1,1.5))),C(da(14,2,14),0,7,0),C(da(8,2,8),0,12,0)),B=Y(C(L(3,2.2,0,32),7,10.5,7),C(L(3,2.2,0,32),-7,10.5,7),C(L(3,2.2,0,
32),7,10.5,-7),C(L(3,2.2,0,32),-7,10.5,-7),C(L(6,3.5,0,32),0,20,0)),F=Ja([1.5,0,-1.5,0,-1.5,4,-1.2,4.5,-.8,4.8,0,5,.8,4.8,1.2,4.5,1.5,4],.2);A=Na(t(),ra(),t(1.5,1.7,2));let M=la(R(f),A),V=C(Oa(Db(L(5,3.6,0,4)),0,1,0,Q/2),0,14.5,-10),sa=Y(la(R(g),A),C(da(5,12,5),0,6,-10));A=la(R(F),Na(t(),wa(0,1,0,Q),t(.5)));let va=Y(C(R(A),3.6,1.7,-3),C(R(A),3.6,1.7,3),C(R(A),-3.6,1.7,-3),C(R(A),-3.6,1.7,3),C(R(A),2.5,8,-10),C(R(A),-2.5,8,-10));return{pb:()=>k(!1),mb:()=>k(!0),ub:()=>{var x=new J(q,{...a,B:t(.75),
O:100});let z=new J(r,{r:.4,o:.4,b:.4,a:1,O:100});var E=new J(m,a);let D=new J(w,a);var I=new J(h,{...a,B:t(.5)});let T=new J(p,{r:1,o:.9,b:0,a:1,Z:0,C:.9});x.i(b);z.i(n);E.i(c);I.i(c);x.g.y=4;z.g.y=9.25;I.g.h(3.85,1.1,0);I.j.l(0,1,0,Q).multiply(wa(1,0,0,-.13));T.g.z=-5;I=new Z;I.g.h(0,8.5,-4);I.a(E,D);E=new Z;E.a(x,z,I,T);let N=ua()*Q;I.A.push(Ta=>Ta.j.l(0,0,1,.1*O.now+N));x=new Z;E.g.z=10.5;x.j.l(0,1,0,Q);return x.a(E)},sb:()=>{let x=new J(u,{r:.8,o:.8,b:.8,a:1,B:t(.75),O:100});x.i(b);return x},
tb:()=>(new J(G,{r:.8,o:.8,b:.8,a:1,B:t(.75),O:100})).i(b),nb:()=>{let x=new Z,z=new J(K,{r:.6,o:.6,b:.6,a:1,B:t(.75),O:100}),E=new J(B,{...a,r:.8,o:.5,b:.35,a:1,B:t(.1,.3,.3),ya:t(.5,.5,0),O:1}),D=new J(F,{r:.7,o:.7,b:.7,a:1,B:t(.5)});z.i(b);E.i(n);D.i(c);D.g.z=8;return x.a(z,E,D)},ob:()=>{var x=new J(sa,a),z={r:.8,o:.4,b:.3,a:1,B:t(.1,.3,.3),ya:t(.5,.5,0),O:10};let E=new J(M,z),D=new J(V,z),I=new J(va,{...a,r:.2,o:.2,b:.2,a:1,C:.2});x.i(b);E.i(d);D.i(n);z=new Z;z.a(x,E,D,I);z.g.z+=2.5;x=new Z;x.j.l(0,
1,0,ka/(.5>ua()?-2:2)+Q);return x.a(z)}}})(),Fa=2E3,Ga=new Set,Pd=t(),Fc=a=>{let {ra:b,node:c,node:{g:d,j:f},Hb:g,Ib:h}=a;if(b){var l=100+100*Ka;a.sa=l;a.G=l}let {hb:k,Xa:n,Ya:q}=Bc(c,2);n.style.background=b?"#f00":"#0f0";c.P.push(()=>k(a.G,a.sa));let r=b?()=>{}:Ua(1,!0,()=>{Qb(-1)||(a.G-=10)}),m=kc(c),p=b?3:42;l=Sa[p];d.h(l.x,0,l.y);f.l(0,1,0,b?Q:ka-.1);let w=4*Math.random()-2,u=t(),v=U(),y=()=>{if(b){if(42<=p)return!1;++p}else{if(p<(0==Ka?15:1==Ka?13:9))return!1;--p}let x=Sa[p];wc(Sa[p+1],x,Sa[p-
1],w,v).a(x);u.h(v.x,0,v.y);return!0};y();y();let G=0;g();let A=null,K=b?t(1,0,0):t(0,0,1),B=K.c(),F=0,M=.8,V=!1;c.R.push(()=>{if(V){h();sa(!1);let I=O.now,T=f.c();c.A.push(()=>{var N=O.now-I;if(1>N)N*=N*N*N*N,f.s(T).multiply(wa(1,0,0,Q*N));else if(4>N)d.y=.4*-La(N-3,0);else return c.X(),!1;return!0});return!1}if(sb)return h(),!1;if(!b||0>=tb){var x=1==G,z=0==G||x,E=A?.node.g??u;z&&1>d.da(E)&&(x?(G=2,z=!1,h()):y()||(G=3,z=!1,h()));B.r().cb(K.r()).r();K.s(E).m(d).r();f.l(0,1,0,yb(-B.x,-B.z));z&&d.a(B.L(2.5*
ma));if(0==G||3==G){x=25;for(var {qa:D}of Ga)D.ra!=b&&(E=D.node.g.da(d),E<x&&(x=E,A=D,G=1,g()))}else 0>=A.G&&(A=null,G=0,g());D=()=>{0>F&&(F+=1.5,M=.8,a.Cb());M-=ma;return 0>M?(M=.8,!0):!1};F-=ma;2==G?D()&&(D=1+Ka,A.G-=40*(b?.95**Rb*D:1.05**Sb),pc(m)):b&&3==G?0<Fa&&D()&&(Fa-=40,pc(m)):F=La(0,F);a.$a=z}for(let {qa:I}of Ga)z=I.node.g,D=Pd.s(d).m(z),x=.8-D.Y,0<x&&(D.Eb().L(x*(I.$a?1:.3)),z.m(D));0>=a.G&&(V=!0,b&&(ha(10),0==--Dc&&(sb=!0,Ec(),Ua(2,!1,()=>Tb(Ka+1,!1)))));return!0});let sa=x=>{r();Ga.delete(va);
q.remove();x&&c.X()},va={qa:a,yb:()=>sa(!0)};Ga.add(va);return()=>sa(!0)},Gc=[{W:60,Na:5,Oa:-.1,pa:qa("0,0,0,0,0,0,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60"),La:50,Ka:30},{W:75,Na:4,Oa:-.1,pa:qa("0,0,0,0,0,15,15,15,15,30,30,30,30,30,45,45,45,45,45,60,60,60,60,60,60,60,60,90,90,90,90,90,90,90,90"),La:100,Ka:50},{W:100,Na:3,Oa:-.05,pa:qa("0,0,0,0,0,0,15,15,15,15,15,15,30,30,30,30,30,30,45,45,45,45,45,45,60,60,60,60,60,60,60,90,90,90,90,90,90,90,120,120,120,120,120,120,120,125,125,125,125,125,125,125,130,130,130,130,130,130,130"),
La:150,Ka:100}],Ub=new Set,ab=a=>{X.a(a);Ub.add(a)},bb=(a,b)=>({show:()=>a.style.display="",Za:()=>a.style.display="none",na:()=>{a.remove();b()},la:a}),ia=(a,b,c,d,f,g,h)=>{let l=ja("div"),k=ja("button"),n=ja("div");l.className="ability-container";k.textContent=a;n.textContent=b;l.appendChild(k);l.appendChild(n);let q=!1,r=()=>{k.disabled=q||na<(f??0)};if(d){let m=ja("div"),p=()=>m.textContent=g??`Can be used every ${d} seconds.`;p();l.appendChild(m);k.onclick=()=>{q=!0;r();let w=d;X.R.push(()=>
{w-=ma;if(0>w)return p(),q=!1,r(),!1;let u=w.toFixed(1);m.textContent=h?.(u)??`Ready in ${u} seconds.`;return!0});c()}}else k.onclick=c;f&&fa.push(r);return{c:l,d:n,b:k}},Va=(a,b)=>{let c=ja("div");c.style.display="none";Qa.appendChild(c);let d=ja("div");d.textContent=a;d.className="title";c.appendChild(d);a=ja("div");a.textContent=b;c.appendChild(a);return c},Ua=(a,b,c)=>{let d=a,f=!1;X.R.push(()=>{if(f)return!1;d-=ma;return 0>d?(d+=a,c(),b):!0});return()=>f=!0},na=0,ub=0,Qd=oa("gold-count"),Vb=
oa("food-count"),fa=[],ha=a=>{Qd.textContent=(na+=a).toString();fa.forEach(b=>b())},vb=1;Ua(1,!0,()=>ha(vb));let Qb=a=>{if(0>ub+a)return!1;Vb.textContent=(ub+=a).toString();0==ub?Vb.classList.add("danger"):Vb.classList.remove("danger");return!0},wb=0;Ua(1,!0,()=>Qb(wb));let Rd=()=>{let a=Va("House","Houses increase the amount of gold you receive per second."),b=1,c=()=>{d.b.disabled=30>na;d.d.textContent=`You receive ${b} additional gold per second. (${b}/3)`},d=ia("Upgrade (30 gold)","",()=>{3==
++b&&d.b.remove();++vb;ha(-30)});a.appendChild(d.c);++vb;c();fa.push(c);return bb(a,()=>{vb-=b;Ia(fa,c)})},Sd=()=>{let a=Va("Castle","The main building of the city. You must protect the castle from enemies."),b=ia("Recruit soldier (5 gold)","You can recruit soldiers to fight enemies.",()=>{let c=Hb(!1,!1);X.a(c.node);Fc(c);ha(-5)},3,5,"You can recruit a soldier every 3 seconds.",c=>`You can recruit a new soldier in ${c} seconds.`);a.appendChild(b.c);a.appendChild(ia("Repair castle","Instantly repair 20% damage done to the castle.",
()=>{Fa=ta(2E3,Fa+400)},60).c);return bb(a,()=>{})},tb=0;X.R.push(()=>{tb=La(tb-ma,0)});let Td=()=>{let a=Va("Church","Provides abilities that can turn the combat in your favor."),b=0,c=0,d=1,f=()=>{b=.2*d;g.d.textContent=`Restores ${20*d}% health to all friendly soldiers.`;c=2*d;h.d.textContent=`Stuns all enemies, making them unable to move or attack for ${c} seconds.`;l.b.disabled=20>na;l.d.textContent=`Increase the power of the church's abilities. (${d}/3)`},g=ia("Blessing","",()=>{for(let {qa:k}of Ga)k.ra||
(k.G=ta(k.sa,k.G+k.sa*b))},15),h=ia("Judgment","",()=>{tb+=c},30),l=ia("Upgrade (20 gold)","",()=>{3==++d&&l.b.remove();ha(-20)});a.appendChild(g.c);a.appendChild(h.c);a.appendChild(l.c);f();fa.push(f);return bb(a,()=>{Ia(fa,f)})},Rb=0,Sb=0,Ud=()=>{let a=Va("Blacksmith","Improves the equipment of your soldiers."),b=1,c=1,d=()=>{let h=Xa(100*(1-.95**b)),l=Xa(100*(1-.95**c));f.b.disabled=20>na;f.d.textContent=`Reduces damage taken by friendly soldiers, by ${h}%. (${b}/3)`;g.b.disabled=20>na;g.d.textContent=
`Increases damage dealt by friendly soldiers, by ${l}%. (${c}/3)`},f=ia("Armor reinforcement (20 gold)","",()=>{3==++b&&f.b.remove();++Rb;ha(-20)}),g=ia("Sharpened swords (20 gold)","",()=>{3==++c&&g.b.remove();++Sb;ha(-20)});a.appendChild(f.c);a.appendChild(g.c);d();fa.push(d);return bb(a,()=>{Ia(fa,d);Sb-=c-1;Rb-=b-1})},Vd=()=>{let a=Va("Windmill","Produces food. Soldiers need food to survive."),b=1;++wb;let c=()=>{d.b.disabled=20>na;d.d.textContent=`Produces ${b} food per second. (${b}/3)`},d=
ia("Upgrade food production (20 gold)","",()=>{3==++b&&d.b.remove();++wb;ha(-20)});a.appendChild(d.c);c();fa.push(c);return bb(a,()=>{Ia(fa,c);wb-=b})},Wd=L(.5,1,1,64),Xd=L(.8,.05,.05),Yd=a=>{let b=Va("Archer tower","Periodically attacks the closest enemy."),c=new J(Wd,{r:0,o:.2,b:.8,a:.3});c.S=!0;c.H=!1;c.N=!1;c.v=!1;a.a(c);let d=0,f=0,g=0,h=0,l=()=>{k.b.disabled=20>na;g=12+4*d;k.d.textContent=`Attack enemies in a ${g} meter radius. (${d+1}/3)`;c.I.h(g,1,g);n.b.disabled=10>na;h=1.05**f;let y=Xa(100*
(1-.95**f));n.d.textContent=`Damage done increased by ${y}%. (${f}/3)`},k=ia("Increase range by 3 meters (20 gold)","",()=>{2==++d&&k.b.remove();ha(-20)}),n=ia("Increase damage done by 5% (10 gold)","",()=>{3==++f&&n.b.remove();ha(-10)});b.appendChild(k.c);b.appendChild(n.c);l();fa.push(l);let q=Hb(!1,!0);q.node.g.y=9;a.a(q.node);let r=kc(q.node),m=2,p=t(0,0,-1),w=t(0,0,-1),u=()=>!0,v=!0;a.R.push(()=>{if(0>=Fa)return!1;m-=ma;var y=null;let G=Infinity;for(let {qa:A}of Ga)if(A.ra){let K=a.g.da(A.node.g);
K<G&&(G=K,y=A)}if(y&&(p.s(y.node.g).m(a.g).r(),w.cb(p).r(),q.node.j.l(0,1,0,yb(-w.x,-w.z)),0>=m&&G<g*g)){y.G-=30*h;m=2;md(r);let A=q.wb.za,K=y.node.g.c();K.y+=1.5;y=K.c().m(A).r();let B=new J(Xd,{...Gb});B.j.Gb(t(0,1,0),y);X.a(B);let F=0;u=()=>{F+=ma;B.g.eb(A,K,F/.1);return.1<F?(B.X(),!1):!0}}u()||(u=()=>!0);return v});return{show(){b.style.display="";c.v=!0},Za(){b.style.display="none";c.v=!1},na(){Ia(fa,l);b.remove();v=!1},la:b}},Wb={[0]:{m:t(10,6,7),c:25,n:"house"},[1]:{m:t(10,6,7),c:25,n:"blacksmith"},
[2]:{m:t(31,8,14),c:15,n:"windmill"},[3]:{m:t(6,9,6),c:40,n:"archer tower"},[5]:{m:t(22,23,22),c:0,n:"castle"},[4]:{m:t(10,10,22),c:25,n:"church"}},Ea=[],aa=new J(C(da(),0,.5,0),{r:1,o:0,b:0,a:.3});aa.S=!0;aa.H=!1;aa.N=!1;aa.J=null;let Ra=()=>{},Xb=()=>{},Hc=oa("overlay"),cb=oa("overlay-text"),Wa=oa("start-level"),ya=Gc[0],Ka=0,Dc=0,Ic=null,sb=!1,Yb=[],Tb=async(a,b)=>{Hc.classList.remove("hidden");Nb=!1;if(b)cb.textContent="The enemy destroyed your castle...",Wa.textContent="Try again";else if(0==
a)cb.textContent="The enemy is attacking the city, you need to defend it!\nAre you ready?",Wa.textContent="Let's go!";else if(1==a)cb.textContent="You won the battle, but the war is still far from over.\nThe enemy will be back very soon. You must prepare.",Wa.textContent="I'm ready!",db(5.5),setTimeout(()=>db(5),1E4);else if(2==a)cb.textContent="This is the final attack. The enemy is stronger than ever.\nCan you defend the city one last time?",Wa.textContent="Let's do it!",db(4.5),setTimeout(()=>
db(4),1E4);else{cb.textContent="Congratulations!\n\nYou have successfully defended the city from all attacks.\nThe war is finally over.";Wa.style.display="none";gb.gain.linearRampToValueAtTime(.2,H.currentTime+.1);gb.gain.linearRampToValueAtTime(0,H.currentTime+20);setTimeout(Jc,25E3);return}await new Promise(v=>Xb=v);Xb=()=>{};let {W:c,Oa:d}=ya=Gc[Ka=a];sb=!1;Ra();Ea.forEach(({ia:v})=>{v.na();v.la.remove()});Ea=[];Qa.style.display="none";Ub.forEach(v=>v.X());Ub.clear();Ic?.remove();Ga.forEach(v=>
v.yb());Ga.clear();Yb.forEach(v=>v());Yb=[];a=c*pa;b=Math.ceil((a-20)/50);for(var f=0;f<b;++f){var g=50*f/a,h=za(g*pa+d)*c;g=ba(g*pa+d)*c;var l=Cc();l.g.h(-h,0,-g);ab(l);if(f!=b-1){h=Ld();ab(h);l=c-ya.Na;let v=50*(f+.5)/a;g=za(v*pa+d)*l;l*=ba(v*pa+d);h.g.h(-g,0,-l);h.j.l(0,1,0,-yb(l,g)-Q)}}let k=Md();k.g.h(10,0,-30);k.j.l(0,1,0,-.1);ab(k);let {hb:n,Xa:q,Ya:r}=Bc(k,25);q.style.background="#0f0";r.style.width="25vh";k.P.push(()=>n(Fa,2E3));Ic=r;Fa=2E3;({m:a}=Wb[5]);let m={node:k,type:5,Ea:t(10-a.x/
2,0,-30-a.z/2),Da:t(10+a.x/2,a.y,-30+a.z/2),ia:Sd()};Ea.push(m);let p=!1,w=0;k.A.push(()=>{if(p){let v=ta((O.now-w)/3,1);k.g.y=-v*v*v*25;return 1>v}0>=Fa&&(p=!0,w=O.now,r.remove(),Ia(Ea,m),m.ia.na(),Qa.style.display="none",sb=!0,Ec(),Ua(3,!1,()=>Tb(Ka,!0)));return!0});for(var u of ya.pa)Yb.push(Ua(u,!1,()=>{let v=Hb(!0,!1);X.a(v.node);Fc(v)}));Dc=ya.pa.length;na=ya.La;ub=ya.Ka;ha(0);Qb(0);u=Ma(0);for(a=0;100>a;++a)b=c+20,f=250*Zb(u()),f<b||(h=u()*pa,b=za(h)*f,f*=ba(h),0>b&&10>xb(f-20)||(h=vd(),h.g.h(b,
0,f),ab(h)))},Lb=!1,Zd=a=>{Lb=!0;Qa.style.display="none";let {m:b,c}=Wb[a];aa.I.s(b);let d=U(b.x,b.z).L(.5),f=U(),g=U(),h=U(),l=U();Ra();Ra=()=>{Lb=!1;X.r(aa);W.removeEventListener("click",n);W.removeEventListener("mousemove",m)};let k=!1,n=p=>{if(k){Ra();Ra=()=>{};var w=Da.i(p),u=cc(w),v=[Id,Jd,Kd,Cc,Nd][a]();w.Wa(u,v.g);ab(v);var y=O.now,G=(B,F)=>{B=ta(B/.7,1);var M=F?1-B:B,V=La(.001,(8*M)**1.3);F=v.I;V=ba(V)/V;M=fb((M-1)/-1,0,1);F.y=1-V*M*M*(3-2*M);return 1>B};v.A.push(()=>G(O.now-y,!1));var A=
[Rd,Ud,Vd,Yd,Td][a](v),K={node:v,type:a,Ea:t(g.x,0,g.y),Da:t(h.x,b.y,h.y),ia:A};w=ia("Destroy building","Destroys this building, freeing up space for other buildings.",()=>{Ia(Ea,K);A.na();A.la.remove();Qa.style.display="none";let B=O.now;v.A.push(()=>{let F=G(O.now-B,!0);F||v.X();return F})});w.b.style.background="#b33";A.la.appendChild(w.c);Ea.push(K);ha(-c);Mb(p)}},q=U(),r=U(),m=p=>{p=Da.i(p);var w=cc(p);p.Wa(w,aa.g);aa.g.Y>ya.W-8&&aa.g.r().L(ya.W-8);aa.g.y-=.01;X.a(aa);let {x:u,z:v}=aa.g;f.h(u,
v);g.s(f).m(d);h.s(f).a(d);k=!0;for(let {Ea:y,Da:G}of Ea)if(p=q.h(y.x,y.z),w=r.h(G.x,G.z),p.x<h.x&&p.y<h.y&&w.x>g.x&&w.y>g.y){k=!1;break}if(k){p=U();for(let y of Sa)if(w=p.s(y).Sa(g,h),16>y.da(w)){k=!1;break}}if(k)for(let [y,G]of[[g.x,g.y],[h.x,g.y],[g.x,h.y],[h.x,h.y]])if(l.h(y,G).Y>ya.W-8){k=!1;break}aa.K.r=k?0:1;aa.K.o=k?1:0};W.addEventListener("click",n);W.addEventListener("mousemove",m)},$d=oa("bc");for(let a of[0,1,2,3,4]){let {c:b,n:c}=Wb[a],d=ja("button");d.textContent=`Build ${c} (${b} gold)`;
d.onclick=()=>Zd(a);$d.appendChild(d);fa.push(()=>{d.disabled=na<b})}let Jc=()=>{},db=()=>{},Kc=!1;Wa.onclick=()=>{Hc.classList.add("hidden");Nb=!0;Xb();if(!Kc){ea.frequency.value=200;let {stop:a,Fb:b}=nd();Jc=a;db=b;Kc=!0}ea.frequency.exponentialRampToValueAtTime(200,H.currentTime+.1);ea.frequency.exponentialRampToValueAtTime(6E3,H.currentTime+3);ea.frequency.exponentialRampToValueAtTime(2E4,H.currentTime+4)};let Ec=()=>{ea.frequency.linearRampToValueAtTime(2E4,H.currentTime+.1);ea.frequency.linearRampToValueAtTime(200,
H.currentTime+4)};oa("lo").style.display="none";Tb(0,!1)},100);
